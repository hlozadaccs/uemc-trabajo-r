---
title: "UEMC R"
author: "Héctor Lozada"
date: "19 de noviembre de 2018"
output:
  pdf_document: default
  html_document: default
---

INFORME A SUAVECITO.ES
======================

El siguiente estudio está basado en los datos publicados por el usuario Miguel Gil en la red social [kaggle](https://www.kaggle.com/).

# Estudio y análisis de datos

Haciendo uso de técnicas de análisis de datos en el lenguaje de programación **R**, se ha determinado:

```{r, echo = FALSE}
library(ggplot2)
female_data <- read.csv('female_names.csv', header = TRUE)
male_data <- read.csv('male_names.csv', header = TRUE)

female_max <- female_data[which.max(female_data$frequency),]
male_max <- male_data[which.max(male_data$frequency),]

get_frecuency_range <- function(dataframe, gender) {
  l <- seq(5, 85, by=5)
  df <- data.frame(mean_age = numeric(), female_count = numeric())
  
  for (i in seq_along(l)) {
    temp_data <- dataframe[dataframe$mean_age >= (l[i] - 5) & dataframe$mean_age < l[i], ]
    df <- rbind(df, data.frame(
      gender = gender,
      mean_age = l[i],
      frecuency = sum(temp_data$frequency)))    
  }

  return (df)
}
```

## Cantidad de nombres femeninos y masculinos con mayor frecuencia

El nombre femenino mas repetido ha sido **`r female_max$name `** con una aparición de **`r format(female_max$frequency, digits=9, big.mark=" ", small.interval=3)`**, por otra parte el nombre masculino mas repetido ha sido **`r male_max$name `** con una aparición de **`r format(male_max$frequency, digits=9, big.mark=" ", small.interval=3)`**

## Gráfica de nombres femeninos

```{r}
female_frequency_range <- get_frecuency_range(female_data, 'female')
ggplot(data=female_frequency_range, aes(x=mean_age, y=frecuency)) +
  geom_histogram(stat='identity', alpha = .4, color = 'red', fill = 'red', position = 'dodge') +
  labs(title='Media de edades género femenino', x='Media de edades', y='Cantidad de nombres')
```

## Gráfica de nombres masculinos

```{r, echo = FALSE}
male_frequency_range <- get_frecuency_range(male_data, 'male')
ggplot(data=male_frequency_range, aes(x=mean_age, y=frecuency)) +
  geom_histogram(stat='identity', alpha = .4, color = 'blue', fill = 'blue', position = 'dodge') +
  labs(title='Media de edades género masculino', x='Media de edades', y='Cantidad de nombres')
```

## Gráfica combinada

```{r, echo = FALSE}
combined_data <- rbind(female_frequency_range, male_frequency_range)
ggplot(combined_data, aes(x=mean_age, y=frecuency, fill=gender)) +
  geom_bar(stat="identity", width=4, position = "dodge") +
  labs(title='Media de edades géneros masculino y femenino', x='Media de edades', y='Cantidad de nombres') +
  scale_fill_manual("Leyenda", values = c("female" = "red", "male" = "blue"), breaks=c("female", "male"), labels=c('Femenino', 'Masculino'))
```