---
title: "UEMC R"
author: "Héctor Lozada"
date: "19 de noviembre de 2018"
output:
  pdf_document: default
  html_document: default
---

INFORME A SUAVECITO.ES
======================

El siguiente estudio está basado en los datos publicados por el usuario Miguel Gil en la red social [kaggle](https://www.kaggle.com/).

# Estudio y análisis de datos

Haciendo uso de técnicas de análisis de datos en el lenguaje de programación **R**, se ha determinado:

```{r, echo = FALSE, message=FALSE, warning=FALSE}
library(ggplot2)
library (knitr)

get_frecuency_range <- function(dataframe, gender) {
  l <- seq(5, 85, by=5)
  df <- data.frame(mean_age = numeric(), female_count = numeric())
  
  for (i in seq_along(l)) {
    temp_data <- dataframe[dataframe$mean_age >= (l[i] - 5) & dataframe$mean_age < l[i], ]
    df <- rbind(df, data.frame(
      gender = gender,
      mean_age = l[i],
      frecuency = sum(temp_data$frequency)))    
  }

  return (df)
}

split_names <- function(name) {
  return (sapply(gregexpr('\\S+', name), length))
}

count_names <- function(df, quantity) {
  return (nrow(df[sapply(df$name, split_names) == quantity, ]))
}

count_frequency_letter <- function(df, letter) {
    return (nrow(df[grep(paste('^', letter, sep=''), df$name), ]))
}

female_data <- read.csv('female_names.csv', header = TRUE)
male_data <- read.csv('male_names.csv', header = TRUE)

female_name_1 <- count_names(female_data, 1)
female_name_2 <- count_names(female_data, 2)
female_name_3 <- count_names(female_data, 3)
male_name_1 <- count_names(male_data, 1)
male_name_2 <- count_names(male_data, 2)
male_name_3 <- count_names(male_data, 3)

female_max <- female_data[which.max(female_data$frequency),]
male_max <- male_data[which.max(male_data$frequency),]

female_frequency_range <- get_frecuency_range(female_data, 'female')
male_frequency_range <- get_frecuency_range(male_data, 'male')
combined_data <- rbind(female_frequency_range, male_frequency_range)
```

## Cantidad de nombres femeninos y masculinos con mayor frecuencia

El nombre femenino mas repetido ha sido **`r female_max$name `** con una aparición de **`r format(female_max$frequency, digits=9, big.mark=" ", small.interval=3)`**, por otra parte el nombre masculino mas repetido ha sido **`r male_max$name `** con una aparición de **`r format(male_max$frequency, digits=9, big.mark=" ", small.interval=3)`**

## Gráfica de nombres femeninos

```{r, echo = FALSE, message=FALSE, warning=FALSE}
ggplot(data=female_frequency_range, aes(x=mean_age, y=frecuency)) +
  geom_histogram(stat='identity', alpha = .4, color = 'red', fill = 'red', position = 'dodge') +
  labs(title='Media de edades género femenino', x='Media de edades', y='Cantidad de nombres')
```

## Gráfica de nombres masculinos

```{r, echo = FALSE, message=FALSE, warning=FALSE}
ggplot(data=male_frequency_range, aes(x=mean_age, y=frecuency)) +
  geom_histogram(stat='identity', alpha = .4, color = 'blue', fill = 'blue', position = 'dodge') +
  labs(title='Media de edades género masculino', x='Media de edades', y='Cantidad de nombres')
```

## Gráfica combinada

```{r, echo = FALSE, message=FALSE, warning=FALSE}
ggplot(combined_data, aes(x=mean_age, y=frecuency, fill=gender)) +
  geom_bar(stat="identity", width=4, position = "dodge") +
  labs(title='Media de edades géneros masculino y femenino', x='Media de edades', y='Cantidad de nombres') +
  scale_fill_manual("Leyenda", values = c("female" = "red", "male" = "blue"), breaks=c("female", "male"), labels=c('Femenino', 'Masculino'))
```

## Nombres compuestos

Los nombres compuestos son aquellos que están formados por dos o mas nombres, se evaluó el listado femenino y masculino de nombres llegando a la siguiente conclusión.

En el listado de nombres femeninos se ha determinado que la cantidad de nombres compuestos es de **`r format(female_name_2 + female_name_3, digits=9, big.mark=" ", small.interval=3)`** de los cuales **`r format(female_name_2, digits=9, big.mark=" ", small.interval=3)`** son nombres compuestos por dos nombres y **`r format(female_name_3, digits=9, big.mark=" ", small.interval=3)`** son nombres compuestos por tres nombres

En el listado de nombres masculinos la cantidad de nombres compuestos son de **`r format(male_name_2 + male_name_3, digits=9, big.mark=" ", small.interval=3)`**, **`r format(male_name_2, digits=9, big.mark=" ", small.interval=3)`** son nombres compuestos por dos nombres y **`r format(male_name_3, digits=9, big.mark=" ", small.interval=3)`** son nombres compuestos por tres nombres

## Total de nombres simples y compuestos.

```{r, echo = FALSE, message=FALSE, warning=FALSE}
df <- data.frame(group = c('Nombres femeninos simples', 'Nombres femeninos compuestos', 'Nombres masculinos simples', 'Nombres masculinos compuestos'), value = c(female_name_1, female_name_2 + female_name_3, male_name_1, male_name_2 + male_name_3))
ggplot(df, aes(x='', y=value, fill=group)) + 
  geom_bar(width = 1, stat = 'identity') +
  coord_polar("y", start=0)
```

## Total de nombres por letra.

```{r}
total_letters <- data.frame(letter <- character(), total_female <- numeric(), total_male <- numeric())
for (letter in LETTERS) {
    total_letters <- rbind(total_letters, data.frame(
        letter = letter,
        total_female = count_frequency_letter(female_data, letter),
        total_male = count_frequency_letter(male_data, letter)))
}
```

`r kable(total_letters)`